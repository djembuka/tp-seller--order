{"version":3,"file":"application.bundle.js","sources":["../src/stores/order.js","../src/components/application.js","../src/loader.js"],"sourcesContent":["import { defineStore } from 'ui.vue3.pinia';\r\n\r\nexport const orderStore = defineStore('order', {\r\n  state: () => ({\r\n    OPTIONS: {},\r\n    controls: {},\r\n    result: {},\r\n    location: {},\r\n    personTypeOld: '',\r\n    loading: false,\r\n    sessid: window.BX.bitrix_sessid(),\r\n  }),\r\n  getters: {\r\n    formData(state) {\r\n      const result = {};\r\n\r\n      Object.entries(state.controls).forEach((entry) => {\r\n        entry[1].forEach((control) => {\r\n          if (entry[0] === 'location' && typeof control.value === 'object') {\r\n            result[control.name] = control.value.id;\r\n          } else {\r\n            result[control.name] = control.value;\r\n          }\r\n        });\r\n      });\r\n\r\n      return result;\r\n    },\r\n  },\r\n  actions: {\r\n    sendForm() {\r\n      BX.ajax.submitAjax(BX('bx-soa-order-form'), {\r\n        url: this.OPTIONS.ajaxUrl,\r\n        method: 'POST',\r\n        dataType: 'json',\r\n        data: {\r\n          via_ajax: 'Y',\r\n          action: 'saveOrderAjax',\r\n          sessid: BX.bitrix_sessid(),\r\n          SITE_ID: this.OPTIONS.siteID,\r\n          signedParamsString: this.OPTIONS.signedParamsString,\r\n        },\r\n        onsuccess: (result) => {\r\n          console.log(result);\r\n        },\r\n        onfailure: (error) => {\r\n          console.log(error);\r\n        },\r\n      });\r\n    },\r\n    loadData() {\r\n      this.loading = true;\r\n\r\n      const self = this;\r\n\r\n      BX.ajax({\r\n        method: 'POST',\r\n        dataType: 'json',\r\n        url: this.OPTIONS.ajaxUrl,\r\n        data: this.getData(),\r\n        onsuccess: (result) => {\r\n          self.loading = false;\r\n          self.setLoadResult({ result });\r\n          self.setPersonTypeOld(self.result.order);\r\n          this.createLocation({\r\n            data: self.result.order,\r\n            locations: self.result.locations,\r\n          });\r\n          self.createControls(self.result.order);\r\n        },\r\n        onfailure: (error) => {},\r\n      });\r\n    },\r\n    getData() {\r\n      return {\r\n        order: this.formData,\r\n        sessid: this.sessid,\r\n        via_ajax: 'Y',\r\n        SITE_ID: this.OPTIONS.siteID,\r\n        signedParamsString: this.OPTIONS.signedParamsString,\r\n        'soa-action': 'refreshOrderAjax',\r\n      };\r\n    },\r\n    changeControlValue({ control, value, checked }) {\r\n      switch (control.property) {\r\n        case 'text':\r\n        case 'textarea':\r\n          this.changeTextControlValue({ control, value });\r\n          break;\r\n        case 'hint':\r\n          this.changeHintControlValue({ control, value });\r\n          break;\r\n        case 'multiselect':\r\n          this.changeMultiselectValue({ control, value, checked });\r\n          break;\r\n        case 'checkbox':\r\n          this.changeCheckboxValue({ control, checked });\r\n          break;\r\n        case 'select':\r\n          this[\r\n            `changeSelect${control.type\r\n              .substring(0, 1)\r\n              .toUpperCase()}${control.type.substring(1).toLowerCase()}Value`\r\n          ]({ control, value });\r\n          break;\r\n        case 'file':\r\n          this.changeFileValue({ control, value });\r\n          break;\r\n        case 'date':\r\n          this.changeDateValue({ control, value });\r\n          break;\r\n        case 'color':\r\n          this.changeColorValue({ control, value });\r\n          break;\r\n      }\r\n    },\r\n    changeTextControlValue({ control, value }) {\r\n      control.value = value;\r\n    },\r\n    changeHintControlValue({ control, value }) {\r\n      control.value = value;\r\n      if (typeof value === 'object') {\r\n        this.location.last = value;\r\n      }\r\n    },\r\n    changeSelectRadioValue({ control, value }) {\r\n      control.value = value;\r\n    },\r\n    setLoadResult({ result }) {\r\n      this.result = result;\r\n    },\r\n    setPersonTypeOld(data) {\r\n      this.personTypeOld = Object.entries(data.PERSON_TYPE).find(\r\n        (entry) => entry[1].CHECKED === 'Y'\r\n      )[0];\r\n    },\r\n    createData() {\r\n      this.setPersonTypeOld(this.OPTIONS.result);\r\n      this.createLocation({\r\n        data: this.OPTIONS.result,\r\n        locations: this.OPTIONS.locations,\r\n      });\r\n      this.createControls();\r\n    },\r\n    createLocation({ data, locations }) {\r\n      const id = Object.keys(locations)[0];\r\n      const orderProp = data.ORDER_PROP.properties.find(\r\n        (p) => p.IS_LOCATION === 'Y'\r\n      );\r\n\r\n      //get location name\r\n      const string = Object.values(locations)[0].output[0];\r\n      const index1 = string.indexOf('pathNames');\r\n      const index2 = string.indexOf('}', index1);\r\n      const sub = string.substring(index1 - 1, index2 + 1);\r\n      const obj = JSON.parse(`{${sub.replace(/'/gi, `\"`)}}`);\r\n      const name = Object.values(obj.pathNames)[1];\r\n\r\n      this.location = {\r\n        label: orderProp.NAME,\r\n        inputId: id,\r\n        last: { id: orderProp.VALUE[0], value: name },\r\n      };\r\n    },\r\n    createControls(data = this.OPTIONS.result) {\r\n      //location\r\n      const location = [\r\n        {\r\n          property: 'hint',\r\n          id: 'twpxOrderLocationId',\r\n          name: `ORDER_PROP_${this.location.inputId}`,\r\n          value: this.location.last || '',\r\n          count: 3,\r\n          action: 'twinpx:location-hint',\r\n          required: false,\r\n          disabled: false,\r\n        },\r\n      ];\r\n\r\n      //person type\r\n      const personType = [\r\n        {\r\n          property: 'select',\r\n          type: 'radio',\r\n          id: 'radioID',\r\n          name: 'PERSON_TYPE',\r\n          label: 'Person types',\r\n        },\r\n      ];\r\n      if (data) {\r\n        personType[0].options = Object.values(data.PERSON_TYPE).map((p) => {\r\n          return {\r\n            label: p.NAME,\r\n            code: p.ID,\r\n          };\r\n        });\r\n      }\r\n      personType[0].value = Object.values(data.PERSON_TYPE).find(\r\n        (p) => p.CHECKED === 'Y'\r\n      ).ID;\r\n\r\n      //delivery\r\n      const delivery = [\r\n        {\r\n          property: 'select',\r\n          type: 'radio',\r\n          id: 'ID_DELIVERY_ID_',\r\n          name: 'DELIVERY_ID',\r\n          label: 'Delivery',\r\n        },\r\n      ];\r\n      if (data) {\r\n        delivery[0].options = Object.values(data.DELIVERY).map((d) => {\r\n          return {\r\n            label: d.NAME,\r\n            code: d.ID,\r\n          };\r\n        });\r\n      }\r\n      delivery[0].value = Object.values(data.DELIVERY).find(\r\n        (d) => d.CHECKED === 'Y'\r\n      ).ID;\r\n\r\n      //paysystem\r\n      const paysystem = [\r\n        {\r\n          property: 'select',\r\n          type: 'radio',\r\n          id: 'ID_PAY_SYSTEM_ID_',\r\n          name: 'PAY_SYSTEM_ID',\r\n          label: 'Pay system',\r\n        },\r\n      ];\r\n      if (data) {\r\n        paysystem[0].options = Object.values(data.PAY_SYSTEM).map((p) => {\r\n          return {\r\n            label: p.NAME,\r\n            code: p.ID,\r\n          };\r\n        });\r\n      }\r\n      paysystem[0].value = Object.values(data.PAY_SYSTEM).find(\r\n        (p) => p.CHECKED === 'Y'\r\n      ).ID;\r\n\r\n      //order prors\r\n      let orderProps = [];\r\n\r\n      if (data) {\r\n        orderProps = data.ORDER_PROP.properties.map((p) => {\r\n          let property = 'text';\r\n          if (p.IS_ADDRESS === 'Y') {\r\n            property = 'textarea';\r\n          }\r\n          return {\r\n            property,\r\n            id: p.ID,\r\n            name: `ORDER_PROP_${p.ID}`,\r\n            label: p.NAME,\r\n            value: p.VALUE[0],\r\n            required: false,\r\n            disabled: false,\r\n          };\r\n        });\r\n      }\r\n\r\n      this.controls = {\r\n        hidden: [\r\n          {\r\n            property: 'text',\r\n            id: 'sessid',\r\n            name: 'sessid',\r\n            label: 'sessid',\r\n            value: window.BX.bitrix_sessid(),\r\n            required: false,\r\n            disabled: false,\r\n          },\r\n          {\r\n            property: 'text',\r\n            id: 'soaAction',\r\n            name: 'soa-action',\r\n            label: 'soa-action',\r\n            value: 'saveOrderAjax',\r\n            required: false,\r\n            disabled: false,\r\n          },\r\n          {\r\n            property: 'text',\r\n            id: 'locationType',\r\n            name: 'location_type',\r\n            label: 'location_type',\r\n            value: 'code',\r\n            required: false,\r\n            disabled: false,\r\n          },\r\n          {\r\n            property: 'text',\r\n            id: 'BUYER_STORE',\r\n            name: 'BUYER_STORE',\r\n            label: 'BUYER_STORE',\r\n            value: String(data.BUYER_STORE),\r\n            required: false,\r\n            disabled: false,\r\n          },\r\n          {\r\n            property: 'text',\r\n            id: 'RECENT_DELIVERY_VALUE',\r\n            name: 'RECENT_DELIVERY_VALUE',\r\n            label: 'RECENT_DELIVERY_VALUE',\r\n            value: this.location.last.id,\r\n            required: false,\r\n            disabled: false,\r\n          },\r\n          {\r\n            property: 'text',\r\n            id: 'PERSON_TYPE_OLD',\r\n            name: 'PERSON_TYPE_OLD',\r\n            label: 'PERSON_TYPE_OLD',\r\n            value: this.personTypeOld,\r\n            required: false,\r\n            disabled: false,\r\n          },\r\n        ],\r\n        personType,\r\n        delivery,\r\n        paysystem,\r\n        orderProps,\r\n        location,\r\n      };\r\n    },\r\n    loadLocationHints({ control, action }, callback = () => {}) {\r\n      control.loading = true;\r\n\r\n      const data = {\r\n        select: {\r\n          1: 'CODE',\r\n          2: 'TYPE_ID',\r\n          VALUE: 'ID',\r\n          DISPLAY: 'NAME.NAME',\r\n        },\r\n        additionals: {\r\n          1: 'PATH',\r\n        },\r\n        filter: {\r\n          '=PHRASE': control.value.forEach\r\n            ? control.value.value\r\n            : control.value,\r\n          '=NAME.LANGUAGE_ID': 'ru',\r\n          '=SITE_ID': 's1',\r\n        },\r\n        version: '2',\r\n        PAGE_SIZE: '10',\r\n        PAGE: '0',\r\n      };\r\n\r\n      BX.ajax({\r\n        method: 'POST',\r\n        dataType: 'json',\r\n        url: '/bitrix/components/bitrix/sale.location.selector.search/get.php',\r\n        data,\r\n        onsuccess: (result) => {\r\n          control.loading = false;\r\n          resultFn(result);\r\n        },\r\n        onfailure: (error) => {\r\n          console.log(error);\r\n        },\r\n      });\r\n\r\n      function resultFn(result) {\r\n        if (!result.data || !result.data.ITEMS || !result.data.ITEMS.map) {\r\n          return;\r\n        }\r\n\r\n        control.hints = result.data.ITEMS.map((obj) => {\r\n          return {\r\n            id: obj.CODE,\r\n            value: obj.DISPLAY,\r\n          };\r\n        });\r\n\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      }\r\n    },\r\n    setLocationHints({ control, value }) {\r\n      control.hints = value;\r\n    },\r\n  },\r\n});\r\n","import './application.css';\r\n\r\nimport { LocationComponent } from 'local.vue-components.location-component';\r\nimport { ControlComponent } from 'local.vue-components.control-component';\r\nimport { LoaderCircle } from 'local.vue-components.loader-circle';\r\nimport { ButtonComponent } from 'local.vue-components.button-component';\r\n\r\nimport { mapState, mapActions } from 'ui.vue3.pinia';\r\nimport { orderStore } from '../stores/order';\r\n\r\nexport const Application = {\r\n  data() {\r\n    return {\r\n      locations: undefined,\r\n    };\r\n  },\r\n  components: {\r\n    LocationComponent,\r\n    ControlComponent,\r\n    LoaderCircle,\r\n    ButtonComponent,\r\n  },\r\n  // language=Vue\r\n\r\n  template: `\r\n  <LoaderCircle :show=\"loading\" />\r\n  <form id=\"bx-soa-order-form\" ref=\"form\">\r\n\r\n    <fieldset>\r\n      <legend>Person type</legend>\r\n      <div v-for=\"control in controls.personType\" :key=\"control.id\">\r\n        <ControlComponent :control=\"control\" @input=\"input\" @hints=\"hints\" />\r\n      </div>\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <fieldset>\r\n      <legend>Delivery</legend>\r\n      <div v-for=\"control in controls.delivery\" :key=\"control.id\">\r\n        <ControlComponent  :control=\"control\" @input=\"input\" @hints=\"hints\" />\r\n      </div>\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <fieldset>\r\n      <legend>Location</legend>\r\n      <hr>\r\n      <div v-for=\"control in controls.location\" :key=\"control.id\">\r\n        <LocationComponent :control=\"control\" @input=\"input\" @hints=\"locationHints\" />\r\n      </div>\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <fieldset>\r\n      <legend>Paysystem</legend>\r\n      <div v-for=\"control in controls.paysystem\" :key=\"control.id\">\r\n        <ControlComponent :control=\"control\" @input=\"input\" @hints=\"hints\" />\r\n      </div>\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <fieldset>\r\n      <legend>Order props</legend>\r\n      <hr>\r\n      <div v-for=\"(control, index) in controls.orderProps\" :key=\"control.id\">\r\n        <ControlComponent :control=\"control\" @input=\"input\" @hints=\"hints\" />\r\n        <hr v-if=\"index + 1 < controls.orderProps.length\">\r\n      </div>\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <fieldset>\r\n      <legend>Comment</legend>\r\n      <ControlComponent :control=\"{\r\n            property: 'textarea',\r\n            id: 'orderDescription',\r\n            name: 'ORDER_DESCRIPTION',\r\n            label: 'Comment',\r\n            value: '',\r\n            required: false,\r\n            disabled: false,\r\n          }\" @input=\"input\" @hints=\"hints\" />\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <fieldset>\r\n      <legend>Hidden</legend>\r\n      <hr>\r\n      <div style=\"display: grid; gap: 16px; grid-template-columns: repeat(4, 1fr);\">\r\n        <ControlComponent v-for=\"control in controls.hidden\" :key=\"control.id\" :control=\"control\" @input=\"input\" @hints=\"hints\" />\r\n      </div>\r\n    </fieldset>\r\n\r\n    <hr>\r\n\r\n    <ButtonComponent name=\"Оформить заказ\" @clickButton=\"clickButton\" />\r\n    \r\n  </form>\r\n  `,\r\n  computed: {\r\n    ...mapState(orderStore, ['OPTIONS', 'controls', 'loading']),\r\n    LOCATION() {\r\n      if (this.OPTIONS.locations) {\r\n        return Object.values(this.OPTIONS.locations)[0].lastValue;\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions(orderStore, [\r\n      'changeControlValue',\r\n      'loadData',\r\n      'loadLocationHints',\r\n      'setLocationHints',\r\n      'sendForm',\r\n    ]),\r\n    clickButton() {\r\n      this.sendForm();\r\n    },\r\n    input(attrs) {\r\n      this.changeControlValue(attrs);\r\n\r\n      if (\r\n        attrs.control.type === 'radio' ||\r\n        (attrs.control.property === 'hint' &&\r\n          typeof attrs.control.value === 'object')\r\n      ) {\r\n        this.loadData();\r\n      }\r\n    },\r\n    locationHints({ type, control, action, value }) {\r\n      switch (type) {\r\n        case 'get':\r\n          this.loadLocationHints({\r\n            control,\r\n            action,\r\n          });\r\n          break;\r\n        case 'set':\r\n          this.setLocationHints({\r\n            control,\r\n            value,\r\n          });\r\n          break;\r\n      }\r\n    },\r\n  },\r\n};\r\n","import { BitrixVue } from 'ui.vue3';\r\nimport { Application } from './components/application';\r\nimport { createPinia, setActivePinia } from 'ui.vue3.pinia';\r\nimport { orderStore } from './stores/order';\r\n\r\nexport class OrderMake {\r\n  #store;\r\n  #rootNode;\r\n  #application;\r\n\r\n  constructor(rootNode, options): void {\r\n    this.#store = createPinia();\r\n    this.#rootNode = document.querySelector(rootNode);\r\n    this.options = options;\r\n  }\r\n\r\n  run(): void {\r\n    const self = this;\r\n\r\n    this.#application = BitrixVue.createApp({\r\n      name: 'Order Application',\r\n      components: {\r\n        Application,\r\n      },\r\n      template: '<Application/>',\r\n      mounted() {\r\n        if (self.options && typeof self.options === 'object') {\r\n          Object.keys(self.options).forEach((key) => {\r\n            orderStore()[key] = self.options[key] || '';\r\n          });\r\n        }\r\n\r\n        orderStore().createData();\r\n      },\r\n    });\r\n\r\n    this.#application.use(this.#store);\r\n    this.#application.mount(this.#rootNode);\r\n  }\r\n\r\n  initStorageBeforeStartApplication(): void {\r\n    setActivePinia(this.#store);\r\n  }\r\n\r\n  getOrderStore(): Object {\r\n    return orderStore;\r\n  }\r\n}\r\n"],"names":["orderStore","defineStore","state","OPTIONS","controls","result","location","personTypeOld","loading","sessid","window","BX","bitrix_sessid","getters","formData","Object","entries","forEach","entry","control","value","name","id","actions","sendForm","ajax","submitAjax","url","ajaxUrl","method","dataType","data","via_ajax","action","SITE_ID","siteID","signedParamsString","onsuccess","console","log","onfailure","error","loadData","self","getData","setLoadResult","setPersonTypeOld","order","createLocation","locations","createControls","changeControlValue","checked","property","changeTextControlValue","changeHintControlValue","changeMultiselectValue","changeCheckboxValue","type","substring","toUpperCase","toLowerCase","changeFileValue","changeDateValue","changeColorValue","last","changeSelectRadioValue","PERSON_TYPE","find","CHECKED","createData","keys","orderProp","ORDER_PROP","properties","p","IS_LOCATION","string","values","output","index1","indexOf","index2","sub","obj","JSON","parse","replace","pathNames","label","NAME","inputId","VALUE","count","required","disabled","personType","options","map","code","ID","delivery","DELIVERY","d","paysystem","PAY_SYSTEM","orderProps","IS_ADDRESS","hidden","String","BUYER_STORE","loadLocationHints","callback","select","DISPLAY","additionals","filter","version","PAGE_SIZE","PAGE","resultFn","ITEMS","hints","CODE","setLocationHints","Application","undefined","components","LocationComponent","ControlComponent","LoaderCircle","ButtonComponent","template","computed","mapState","LOCATION","lastValue","methods","mapActions","clickButton","input","attrs","locationHints","OrderMake","rootNode","createPinia","document","querySelector","BitrixVue","createApp","mounted","key","use","mount","setActivePinia"],"mappings":"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"}