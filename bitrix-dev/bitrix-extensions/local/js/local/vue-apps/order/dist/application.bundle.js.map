{"version":3,"file":"application.bundle.js","sources":["../src/stores/data.js","../src/components/application.js","../src/loader.js"],"sourcesContent":["import { defineStore } from 'ui.vue3.pinia';\r\n\r\nexport const dataStore = defineStore('data', {\r\n  state: () => ({\r\n    sessionid: '',\r\n    signedParameters: '',\r\n  }),\r\n});\r\n","import './application.css';\r\n\r\nimport { mapState, mapActions } from 'ui.vue3.pinia';\r\nimport { dataStore } from '../stores/data';\r\n\r\nexport const Application = {\r\n  data() {\r\n    return {\r\n      locations: undefined,\r\n      order: undefined,\r\n\r\n      PROPERTIES: undefined,\r\n      DELIVERY_LIST: undefined,\r\n      DELIVERY_ERRORS: undefined,\r\n      PAY_SYSTEM_LIST: undefined,\r\n      PAY_SYSTEM_ERRORS: undefined,\r\n      BASKET: undefined,\r\n      PRODUCTS_BASE_PRICE_DISPLAY: undefined,\r\n      PRODUCTS_PRICE_DISPLAY: undefined,\r\n      PRODUCTS_DISCOUNT_DISPLAY: undefined,\r\n      DELIVERY_BASE_PRICE_DISPLAY: undefined,\r\n      DELIVERY_PRICE_DISPLAY: undefined,\r\n      DELIVERY_DISCOUNT_DISPLAY: undefined,\r\n      SUM_BASE_DISPLAY: undefined,\r\n      DISCOUNT_VALUE_DISPLAY: undefined,\r\n      SUM_DISPLAY: undefined,\r\n    };\r\n  },\r\n  components: {},\r\n  // language=Vue\r\n\r\n  template: `\r\n  <button @click.prevent=\"load\">Load</button>\r\n    <form action=\"\" method=\"post\" name=\"os-order-form\" id=\"os-order-form\">\r\n      <input type=\"hidden\" name=\"person_type_id\" :value=\"PERSON_TYPE_ID\">\r\n      <h2>{{OPEN_SOURCE_ORDER_TEMPLATE_PROPERTIES_TITLE}}</h2>\r\n      <table>\r\n\r\n        <tr v-for=\"arProp in PROPERTIES\" :key=\"arProp.ID\">\r\n          <td>\r\n            <label :for=\"arProp.FORM_LABEL\">\r\n              {{arProp.NAME}}\r\n              <span class=\"required\" style=\"color: red;\" title=\"%s\" v-if=\"arProp.IS_REQUIRED\">*</span>\r\n            </label>\r\n            <!--<div class=\"error\" data-v-for=\"error in arProp.ERRORS\" data-key=\"error.id\">error.getMessage()</div>-->\r\n          </td>\r\n          <td>\r\n            <div v-if=\"arProp.TYPE === 'LOCATION'\" class=\"location\">\r\n              <select class=\"location-search\" :name=\"arProp.FORM_NAME\"\r\n                :id=\"arProp.FORM_LABEL\">\r\n                <option :data-data='arProp.LOCATION_DATA' :value=\"arProp.VALUE\">{{arProp.LOCATION_DATA.label}}</option>\r\n              </select>\r\n            </div>\r\n            <div v-else-if=\"arProp.TYPE === 'ENUM'\">\r\n              <div v-for=\"(name, code) in arProp.OPTIONS\">\r\n                <label class=\"enum-option\">\r\n                  <input type=\"radio\" :name=\"arProp.FORM_NAME\" :value=\"code\">\r\n                  {{name}}\r\n                </label>\r\n              </div>\r\n            </div>\r\n            <div v-else-if=\"arProp.TYPE === 'DATE'\">\r\n              <calendar></calendar>\r\n            </div>\r\n            <div v-else-if=\"arProp.TYPE === 'Y/N'\">\r\n              <input :id=\"arProp.FORM_LABEL\" type=\"checkbox\" :name=\"arProp.FORM_NAME\" value=\"Y\">\r\n            </div>\r\n            <div v-else>\r\n              <input :id=\"arProp.FORM_LABEL\" type=\"text\" :name=\"arProp.FORM_NAME\" :value=\"arProp.VALUE\">\r\n            </div>\r\n          </td>\r\n        </tr>\r\n\r\n      </table>\r\n\r\n      <h2>{{OPEN_SOURCE_ORDER_TEMPLATE_DELIVERIES_TITLE}}</h2>\r\n      <!--<div data-v-for=\"error in DELIVERY_ERRORS\" class=\"error\" data-key=\"error.id\">error.getMessage()</div>-->\r\n      <div v-for=\"arDelivery in DELIVERY_LIST\" :key=\"arDelivery.ID\">\r\n        <label>\r\n          <input type=\"radio\" name=\"delivery_id\" :value=\"arDelivery.ID\" :checked=\"arDelivery.CHECKED\">\r\n          {{arDelivery.NAME}}\r\n          {{arDelivery.PRICE_DISPLAY}}\r\n        </label>\r\n        <br>\r\n      </div>\r\n\r\n      <h2>{{OPEN_SOURCE_ORDER_TEMPLATE_PAY_SYSTEMS_TITLE}}</h2>\r\n      <!--<div data-v-for=\"error in PAY_SYSTEM_ERRORS\" class=\"error\" data-key=\"error.id\">error.getMessage()</div>-->\r\n      <div v-for=\"arPaySystem in PAY_SYSTEM_LIST\" :key=\"arPaySystem.ID\">\r\n        <label>\r\n          <input type=\"radio\" name=\"pay_system_id\" :value=\"arPaySystem.ID\" :checked=\"arPaySystem.CHECKED\">\r\n          {{arPaySystem.NAME}}\r\n        </label>\r\n        <br>\r\n      </div>\r\n\r\n      <h2>{{OPEN_SOURCE_ORDER_TEMPLATE_BASKET_TITLE}}</h2>\r\n      <table>\r\n        <tr>\r\n          <th>{{OPEN_SOURCE_ORDER_TEMPLATE_BASKET_NAME_COLUMN}}</th>\r\n          <th>{{OPEN_SOURCE_ORDER_TEMPLATE_BASKET_COUNT_COLUMN}}</th>\r\n          <th>{{OPEN_SOURCE_ORDER_TEMPLATE_BASKET_UNIT_PRICE_COLUMN}}</th>\r\n          <th>{{OPEN_SOURCE_ORDER_TEMPLATE_BASKET_DISCOUNT_COLUMN}}</th>\r\n          <th>{{OPEN_SOURCE_ORDER_TEMPLATE_BASKET_TOTAL_COLUMN}}</th>\r\n        </tr>\r\n        <tr v-for=\"arBasketItem in BASKET\" :key=\"arBasketItem.ID\">\r\n          <td>\r\n            {{arBasketItem.NAME}}\r\n            <div v-if=\"arBasketItem.PROPERTIES.length\" class=\"basket-properties\">\r\n              <div v-for=\"arProp in arBasketItem.PROPERTIES\" :key=\"arProp.ID\">\r\n                {{arProp.NAME}}\r\n                {{arProp.VALUE}}\r\n                <br>\r\n              </div>\r\n            </div>\r\n          </td>\r\n          <td>{{arBasketItem.QUANTITY_DISPLAY}}</td>\r\n          <td v-html=\"arBasketItem.BASE_PRICE_DISPLAY\"></td>\r\n          <td v-html=\"arBasketItem.PRICE_DISPLAY\"></td>\r\n          <td v-html=\"arBasketItem.SUM_DISPLAY\"></td>\r\n        </tr>\r\n      </table>\r\n\r\n      <h2>{{OPEN_SOURCE_ORDER_TEMPLATE_ORDER_TOTAL_TITLE}}</h2>\r\n\r\n      <h3>{{OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_PRICES_TITLE}}:</h3>\r\n      <table>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_BASE_PRICE}}</td>\r\n          <td v-html=\"PRODUCTS_BASE_PRICE_DISPLAY\"></td>\r\n        </tr>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_PRICE}}</td>\r\n          <td v-html=\"PRODUCTS_PRICE_DISPLAY\"></td>\r\n        </tr>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_DISCOUNT}}</td>\r\n          <td v-html=\"PRODUCTS_DISCOUNT_DISPLAY\"></td>\r\n        </tr>\r\n      </table>\r\n\r\n      <h3>{{OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_PRICES_TITLE}}:</h3>\r\n      <table>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_BASE_PRICE}}</td>\r\n          <td v-html=\"DELIVERY_BASE_PRICE_DISPLAY\"></td>\r\n        </tr>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_PRICE}}</td>\r\n          <td v-html=\"DELIVERY_PRICE_DISPLAY\"></td>\r\n        </tr>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_DISCOUNT}}</td>\r\n          <td v-html=\"DELIVERY_DISCOUNT_DISPLAY\"></td>\r\n        </tr>\r\n      </table>\r\n\r\n      <h3>{{OPEN_SOURCE_ORDER_TEMPLATE_SUM_TITLE}}:</h3>\r\n      <table>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_TOTAL_BASE_PRICE}}</td>\r\n          <td v-html=\"SUM_BASE_DISPLAY\"></td>\r\n        </tr>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_TOTAL_DISCOUNT}}</td>\r\n          <td v-html=\"DISCOUNT_VALUE_DISPLAY\"></td>\r\n        </tr>\r\n        <tr>\r\n          <td>{{OPEN_SOURCE_ORDER_TEMPLATE_TOTAL_PRICE}}</td>\r\n          <td v-html=\"SUM_DISPLAY\"></td>\r\n        </tr>\r\n      </table>\r\n\r\n      <input type=\"hidden\" name=\"save\" value=\"y\">\r\n      <br>\r\n      <button type=\"submit\">{{OPEN_SOURCE_ORDER_TEMPLATE_MAKE_ORDER_BUTTON}}</button>\r\n      <br>\r\n      <br>\r\n    </form>\r\n\t`,\r\n  computed: {\r\n    ...mapState(dataStore, [\r\n      'SESSION_ID',\r\n      'SIGNED_PARAMETERS',\r\n      'OPTIONS',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_PROPERTIES_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_DELIVERIES_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_PAY_SYSTEMS_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_BASKET_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_BASKET_NAME_COLUMN',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_BASKET_COUNT_COLUMN',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_BASKET_UNIT_PRICE_COLUMN',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_BASKET_DISCOUNT_COLUMN',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_BASKET_TOTAL_COLUMN',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_ORDER_TOTAL_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_PRICES_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_BASE_PRICE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_PRICE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_PRODUCTS_DISCOUNT',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_PRICES_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_BASE_PRICE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_PRICE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_DELIVERY_DISCOUNT',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_SUM_TITLE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_TOTAL_BASE_PRICE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_TOTAL_DISCOUNT',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_TOTAL_PRICE',\r\n      'OPEN_SOURCE_ORDER_TEMPLATE_MAKE_ORDER_BUTTON',\r\n    ]),\r\n  },\r\n  methods: {\r\n    ...mapActions(dataStore, []),\r\n    load() {\r\n      BX.ajax({\r\n        method: 'POST',\r\n        dataType: 'json',\r\n        url: 'https://seller20testing.twpx.ru/bitrix/components/bitrix/sale.order.ajax/ajax.php',\r\n        data: dataStore().OPTIONS,\r\n        onsuccess: BX.delegate(function (result) {\r\n          this.locations = result.locations;\r\n          this.order = result.order;\r\n        }, this),\r\n        onfailure: BX.delegate(function () {\r\n          this.endLoader();\r\n        }, this),\r\n      });\r\n    },\r\n  },\r\n};\r\n","import { BitrixVue } from 'ui.vue3';\r\nimport { Application } from './components/application';\r\nimport { createPinia, setActivePinia } from 'ui.vue3.pinia';\r\nimport { dataStore } from './stores/data';\r\n\r\nexport class OrderMake {\r\n  #store;\r\n  #rootNode;\r\n  #application;\r\n\r\n  constructor(rootNode, options): void {\r\n    this.#store = createPinia();\r\n    this.#rootNode = document.querySelector(rootNode);\r\n    this.options = options;\r\n  }\r\n\r\n  run(): void {\r\n    const self = this;\r\n\r\n    this.#application = BitrixVue.createApp({\r\n      name: 'Order Application',\r\n      components: {\r\n        Application,\r\n      },\r\n      template: '<Application/>',\r\n      mounted() {\r\n        if (self.options && typeof self.options === 'object') {\r\n          Object.keys(self.options).forEach((key) => {\r\n            dataStore()[key] = self.options[key] || '';\r\n          });\r\n        }\r\n      },\r\n    });\r\n\r\n    this.#application.use(this.#store);\r\n    this.#application.mount(this.#rootNode);\r\n  }\r\n\r\n  initStorageBeforeStartApplication(): void {\r\n    setActivePinia(this.#store);\r\n  }\r\n\r\n  getTableStore(): Object {\r\n    return tableStore;\r\n  }\r\n}\r\n"],"names":["dataStore","defineStore","state","sessionid","signedParameters","Application","data","locations","undefined","order","PROPERTIES","DELIVERY_LIST","DELIVERY_ERRORS","PAY_SYSTEM_LIST","PAY_SYSTEM_ERRORS","BASKET","PRODUCTS_BASE_PRICE_DISPLAY","PRODUCTS_PRICE_DISPLAY","PRODUCTS_DISCOUNT_DISPLAY","DELIVERY_BASE_PRICE_DISPLAY","DELIVERY_PRICE_DISPLAY","DELIVERY_DISCOUNT_DISPLAY","SUM_BASE_DISPLAY","DISCOUNT_VALUE_DISPLAY","SUM_DISPLAY","components","template","computed","mapState","methods","mapActions","load","BX","ajax","method","dataType","url","OPTIONS","onsuccess","delegate","result","onfailure","endLoader","OrderMake","rootNode","options","createPinia","document","querySelector","self","BitrixVue","createApp","name","mounted","Object","keys","forEach","key","use","mount","setActivePinia","tableStore"],"mappings":";;;;EAEO,IAAMA,SAAS,GAAGC,yBAAW,CAAC,MAAM,EAAE;IAC3CC,KAAK,EAAE;MAAA,OAAO;QACZC,SAAS,EAAE,EAAE;QACbC,gBAAgB,EAAE;OACnB;;EACH,CAAC,CAAC;;;;ACPF,EAKO,IAAMC,WAAW,GAAG;IACzBC,IAAI,kBAAG;MACL,OAAO;QACLC,SAAS,EAAEC,SAAS;QACpBC,KAAK,EAAED,SAAS;QAEhBE,UAAU,EAAEF,SAAS;QACrBG,aAAa,EAAEH,SAAS;QACxBI,eAAe,EAAEJ,SAAS;QAC1BK,eAAe,EAAEL,SAAS;QAC1BM,iBAAiB,EAAEN,SAAS;QAC5BO,MAAM,EAAEP,SAAS;QACjBQ,2BAA2B,EAAER,SAAS;QACtCS,sBAAsB,EAAET,SAAS;QACjCU,yBAAyB,EAAEV,SAAS;QACpCW,2BAA2B,EAAEX,SAAS;QACtCY,sBAAsB,EAAEZ,SAAS;QACjCa,yBAAyB,EAAEb,SAAS;QACpCc,gBAAgB,EAAEd,SAAS;QAC3Be,sBAAsB,EAAEf,SAAS;QACjCgB,WAAW,EAAEhB;OACd;KACF;IACDiB,UAAU,EAAE,EAAE;;;IAGdC,QAAQ,u6LAoJR;IACAC,QAAQ,oBACHC,sBAAQ,CAAC5B,SAAS,EAAE,CACrB,YAAY,EACZ,mBAAmB,EACnB,SAAS,EACT,6CAA6C,EAC7C,6CAA6C,EAC7C,8CAA8C,EAC9C,yCAAyC,EACzC,+CAA+C,EAC/C,gDAAgD,EAChD,qDAAqD,EACrD,mDAAmD,EACnD,gDAAgD,EAChD,8CAA8C,EAC9C,kDAAkD,EAClD,gDAAgD,EAChD,2CAA2C,EAC3C,8CAA8C,EAC9C,kDAAkD,EAClD,gDAAgD,EAChD,2CAA2C,EAC3C,8CAA8C,EAC9C,sCAAsC,EACtC,6CAA6C,EAC7C,2CAA2C,EAC3C,wCAAwC,EACxC,8CAA8C,CAC/C,CAAC,CACH;IACD6B,OAAO,kCACFC,wBAAU,CAAC9B,SAAS,EAAE,EAAE,CAAC;MAC5B+B,IAAI,kBAAG;QACLC,EAAE,CAACC,IAAI,CAAC;UACNC,MAAM,EAAE,MAAM;UACdC,QAAQ,EAAE,MAAM;UAChBC,GAAG,EAAE,mFAAmF;UACxF9B,IAAI,EAAEN,SAAS,EAAE,CAACqC,OAAO;UACzBC,SAAS,EAAEN,EAAE,CAACO,QAAQ,CAAC,UAAUC,MAAM,EAAE;YACvC,IAAI,CAACjC,SAAS,GAAGiC,MAAM,CAACjC,SAAS;YACjC,IAAI,CAACE,KAAK,GAAG+B,MAAM,CAAC/B,KAAK;WAC1B,EAAE,IAAI,CAAC;UACRgC,SAAS,EAAET,EAAE,CAACO,QAAQ,CAAC,YAAY;YACjC,IAAI,CAACG,SAAS,EAAE;WACjB,EAAE,IAAI;SACR,CAAC;;;EAGR,CAAC;;;;ACpOD,EAG0C;EAAA;EAAA;AAE1C,MAAaC,SAAS;IAKpB,mBAAYC,QAAQ,EAAEC,OAAO,EAAQ;MAAA;MAAA;QAAA;QAAA;;MAAA;QAAA;QAAA;;MAAA;QAAA;QAAA;;MACnC,sCAAI,UAAUC,yBAAW,EAAE;MAC3B,sCAAI,aAAaC,QAAQ,CAACC,aAAa,CAACJ,QAAQ,CAAC;MACjD,IAAI,CAACC,OAAO,GAAGA,OAAO;;IACvB;MAAA;MAAA,sBAEW;QACV,IAAMI,IAAI,GAAG,IAAI;QAEjB,sCAAI,gBAAgBC,iBAAS,CAACC,SAAS,CAAC;UACtCC,IAAI,EAAE,mBAAmB;UACzB3B,UAAU,EAAE;YACVpB,WAAW,EAAXA;WACD;UACDqB,QAAQ,EAAE,gBAAgB;UAC1B2B,OAAO,qBAAG;YACR,IAAIJ,IAAI,CAACJ,OAAO,IAAI,uBAAOI,IAAI,CAACJ,OAAO,MAAK,QAAQ,EAAE;cACpDS,MAAM,CAACC,IAAI,CAACN,IAAI,CAACJ,OAAO,CAAC,CAACW,OAAO,CAAC,UAACC,GAAG,EAAK;gBACzCzD,SAAS,EAAE,CAACyD,GAAG,CAAC,GAAGR,IAAI,CAACJ,OAAO,CAACY,GAAG,CAAC,IAAI,EAAE;eAC3C,CAAC;;;SAGP,CAAC;QAEF,sCAAI,gBAAcC,GAAG,mCAAC,IAAI,UAAQ;QAClC,sCAAI,gBAAcC,KAAK,mCAAC,IAAI,aAAW;;;MACxC;MAAA,oDAEyC;QACxCC,4BAAc,mCAAC,IAAI,UAAQ;;;MAC5B;MAAA,gCAEuB;QACtB,OAAOC,UAAU;;;IAClB;EAAA;;;;;;;;"}